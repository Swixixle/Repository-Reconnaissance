{
  "prereqs": [
    "Node.js 20+ (with npm)",
    "Python 3.11+",
    "PostgreSQL 14+ running and accessible",
    "jq, unzip (for export/ops scripts)",
    "TypeScript, tsx, drizzle-kit (npm devDependencies)"
  ],
  "install_steps": [
    {
      "step": "Clone the repository",
      "command": null,
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 86,
        "line_end": 86,
        "snippet_hash": "af4db2203afc",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:86"
      }
    },
    {
      "step": "Install Node.js dependencies",
      "command": "npm install",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 88,
        "line_end": 88,
        "snippet_hash": "4be7c6195f60",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:88"
      }
    },
    {
      "step": "Copy environment file template",
      "command": "cp .env.example .env",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 89,
        "line_end": 89,
        "snippet_hash": "232f2a0c483a",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:89"
      }
    },
    {
      "step": "Edit `.env` file and configure required environment variables",
      "command": "edit .env",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 91,
        "line_end": 91,
        "snippet_hash": "ecd94c8e718d",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:91"
      }
    },
    {
      "step": "Install Python dependencies (for analyzer)",
      "command": "pip install -e .",
      "evidence": {
        "path": "README.md",
        "line_start": 25,
        "line_end": 25,
        "snippet_hash": "92755120ac2c",
        "display": "README.md:25"
      }
    }
  ],
  "config": [
    {
      "name": "DATABASE_URL",
      "purpose": "PostgreSQL connection string (required for backend DB access)",
      "evidence": {
        "path": "drizzle.config.ts",
        "line_start": 3,
        "line_end": 3,
        "snippet_hash": "a19790628fbe",
        "display": "drizzle.config.ts:3"
      }
    },
    {
      "name": "AI_INTEGRATIONS_OPENAI_API_KEY",
      "purpose": "OpenAI API key for LLM integration/AI features",
      "evidence": {
        "path": "server/replit_integrations/audio/client.ts",
        "line_start": 10,
        "line_end": 10,
        "snippet_hash": "05da5f1b1281",
        "display": "server/replit_integrations/audio/client.ts:10"
      }
    },
    {
      "name": "AI_INTEGRATIONS_OPENAI_BASE_URL",
      "purpose": "OpenAI API base URL for LLM integration",
      "evidence": {
        "path": "server/replit_integrations/audio/client.ts",
        "line_start": 11,
        "line_end": 11,
        "snippet_hash": "1f70e6a77d42",
        "display": "server/replit_integrations/audio/client.ts:11"
      }
    },
    {
      "name": "API_KEY",
      "purpose": "Required for private/protected API endpoints authentication",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 100,
        "line_end": 100,
        "snippet_hash": "24b9d5caf118",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:100"
      }
    },
    {
      "name": "SESSION_SECRET",
      "purpose": "Session signing key for express-session",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 101,
        "line_end": 101,
        "snippet_hash": "62fec4db8fd5",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:101"
      }
    },
    {
      "name": "PORT",
      "purpose": "Server port (defaults to 5000)",
      "evidence": {
        "path": ".replit",
        "line_start": 14,
        "line_end": 14,
        "snippet_hash": "2cb616fc39c1",
        "display": ".replit:14"
      }
    }
  ],
  "run_dev": [
    {
      "step": "Run the development server (starts backend API and frontend via Vite middleware)",
      "command": "npm run dev",
      "evidence": {
        "path": ".replit",
        "line_start": 2,
        "line_end": 2,
        "snippet_hash": "96fa2e5505e4",
        "display": ".replit:2"
      }
    }
  ],
  "run_prod": [
    {
      "step": "Build the application for production",
      "command": "npm run build",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 119,
        "line_end": 119,
        "snippet_hash": "4124e323d038",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:119"
      }
    },
    {
      "step": "Run the compiled production server",
      "command": "npm run start",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 122,
        "line_end": 122,
        "snippet_hash": "519534c1f466",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:122"
      }
    }
  ],
  "usage_examples": [
    {
      "description": "Health check (API up/ready)",
      "command": "curl http://localhost:5000/api/health"
    },
    {
      "description": "Readiness check",
      "command": "curl http://localhost:5000/api/ready"
    },
    {
      "description": "Verify audit log integrity (requires API_KEY)",
      "command": "curl -H \"x-api-key: <API_KEY>\" http://localhost:5000/api/audit/verify"
    },
    {
      "description": "Export a forensic pack (JSON proof of data integrity)",
      "command": "npx tsx scripts/export_forensic_pack.ts --output <pack.json>"
    },
    {
      "description": "Offline verify a forensic pack",
      "command": "npx tsx scripts/verify_forensic_pack.ts <pack.json>"
    }
  ],
  "verification_steps": [
    {
      "step": "Database schema initialization/migration",
      "command": "npm run db:push",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 108,
        "line_end": 108,
        "snippet_hash": "e73ea833158b",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:108"
      }
    },
    {
      "step": "Verify health endpoint responds",
      "command": "curl http://localhost:5000/api/health",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 128,
        "line_end": 128,
        "snippet_hash": "4994405dd75c",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:128"
      }
    },
    {
      "step": "Verify audit log integrity",
      "command": "curl -H \"x-api-key: <API_KEY>\" http://localhost:5000/api/audit/verify",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 140,
        "line_end": 140,
        "snippet_hash": "66a8604b5116",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:140"
      }
    }
  ],
  "common_failures": [
    {
      "symptom": "401 Unauthorized",
      "cause": "Wrong/missing API_KEY",
      "fix": "Set correct x-api-key header, check .env"
    },
    {
      "symptom": "DB connection errors/crash",
      "cause": "Bad DATABASE_URL, DB offline/wrong",
      "fix": "Check credentials, service, version"
    },
    {
      "symptom": "Server not running on port",
      "cause": "App not started, port conflict",
      "fix": "Check logs, ensure PORT=5000, check if in use"
    },
    {
      "symptom": "Forensic pack tamper undetected",
      "cause": "Bug or script not installed",
      "fix": "Re-export, ensure proper script in place"
    }
  ],
  "unknowns": [
    {
      "what_is_missing": "Production deployment specifics (e.g., Docker/systemd/PM2 outside Replit autoscale)",
      "why_it_matters": "Essential for real-world non-Replit or enterprise-grade operation environments",
      "what_evidence_needed": "docker-compose, production hosting guides, systemd service files, reverse proxy config"
    },
    {
      "what_is_missing": "Detailed database initialization, custom roles/privileges procedure",
      "why_it_matters": "Security and correct DB setup in production, minimal DB privilege principle",
      "what_evidence_needed": "Database schema files, explicit SQL role guides, DB bootstrap scripts"
    },
    {
      "what_is_missing": "Key rotation/management docs for API_KEY/SESSION_SECRET",
      "why_it_matters": "Long-term security hygiene",
      "what_evidence_needed": "Step-by-step operator guide for generating/rotating keys"
    },
    {
      "what_is_missing": "Log file path and viewing commands",
      "why_it_matters": "Troubleshooting and support needs",
      "what_evidence_needed": "File path or command for tailed or collected logs"
    },
    {
      "what_is_missing": "Standalone frontend-only hosting/run commands (non-monolithic deploy)",
      "why_it_matters": "Supports split deployment and versatility",
      "what_evidence_needed": "Static hosting doc or equivalent"
    },
    {
      "what_is_missing": "Outbound webhook integrations",
      "why_it_matters": "Enables automation, SIEM, and alerting",
      "what_evidence_needed": "Webhook/event config or evidence in source tree"
    }
  ],
  "missing_evidence_requests": [
    "Production deployment evidence outside of Replit (manual Docker, systemd, nginx, etc.)",
    "Explicit DB role initialization scripts/guides",
    "API_KEY/SESSION_SECRET rotation/manage procedure docs",
    "Log viewing/storage evidence (log file path or centralized logging commands)",
    "Dedicated instructions for standalone (split) frontend deploy",
    "Evidenced webhook/outbound event configuration"
  ],
  "replit_execution_profile": {
    "run_command": "npm run dev",
    "language": "nodejs",
    "port_binding": {
      "port": null,
      "binds_all_interfaces": true,
      "uses_env_port": true,
      "evidence": [
        {
          "path": "server/index.ts",
          "line_start": 92,
          "line_end": 92,
          "snippet_hash": "75d345a78f84",
          "display": "server/index.ts:92"
        },
        {
          "path": "server/index.ts",
          "line_start": 96,
          "line_end": 96,
          "snippet_hash": "9b7206f3d09a",
          "display": "server/index.ts:96"
        }
      ]
    },
    "required_secrets": [
      {
        "name": "DATABASE_URL",
        "referenced_in": [
          {
            "path": "drizzle.config.ts",
            "line_start": 3,
            "line_end": 3,
            "snippet_hash": "a19790628fbe",
            "display": "drizzle.config.ts:3"
          },
          {
            "path": "drizzle.config.ts",
            "line_start": 12,
            "line_end": 12,
            "snippet_hash": "1005be19f14a",
            "display": "drizzle.config.ts:12"
          },
          {
            "path": "server/db.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "a19790628fbe",
            "display": "server/db.ts:7"
          },
          {
            "path": "server/db.ts",
            "line_start": 13,
            "line_end": 13,
            "snippet_hash": "111f33de9945",
            "display": "server/db.ts:13"
          }
        ]
      },
      {
        "name": "AI_INTEGRATIONS_OPENAI_API_KEY",
        "referenced_in": [
          {
            "path": "server/replit_integrations/audio/client.ts",
            "line_start": 10,
            "line_end": 10,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/audio/client.ts:10"
          },
          {
            "path": "server/replit_integrations/chat/routes.ts",
            "line_start": 6,
            "line_end": 6,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/chat/routes.ts:6"
          },
          {
            "path": "server/replit_integrations/image/client.ts",
            "line_start": 6,
            "line_end": 6,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/image/client.ts:6"
          }
        ]
      },
      {
        "name": "AI_INTEGRATIONS_OPENAI_BASE_URL",
        "referenced_in": [
          {
            "path": "server/replit_integrations/audio/client.ts",
            "line_start": 11,
            "line_end": 11,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/audio/client.ts:11"
          },
          {
            "path": "server/replit_integrations/chat/routes.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/chat/routes.ts:7"
          },
          {
            "path": "server/replit_integrations/image/client.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/image/client.ts:7"
          }
        ]
      }
    ],
    "external_apis": [
      {
        "api": "OpenAI",
        "evidence_files": [
          "server/replit_integrations/audio/client.ts:1",
          "server/replit_integrations/audio/routes.ts:3",
          "server/replit_integrations/chat/routes.ts:2",
          "server/replit_integrations/image/routes.ts:2",
          "server/replit_integrations/image/client.ts:2"
        ]
      }
    ],
    "deployment_assumptions": [
      "Binds to 0.0.0.0 (all interfaces)",
      "Requires 3 secret(s): DATABASE_URL, AI_INTEGRATIONS_OPENAI_API_KEY, AI_INTEGRATIONS_OPENAI_BASE_URL"
    ],
    "observability": {
      "logging": true,
      "health_endpoint": true,
      "evidence": [
        {
          "path": "script/build.ts",
          "line_start": 38,
          "line_end": 38,
          "snippet_hash": "2f74cc3fdab1",
          "display": "script/build.ts:38"
        },
        {
          "path": "server/routes.ts",
          "line_start": 15,
          "line_end": 15,
          "snippet_hash": "f7ba68760271",
          "display": "server/routes.ts:15"
        },
        {
          "path": "shared/schema.ts",
          "line_start": 10,
          "line_end": 10,
          "snippet_hash": "6ccc8e5d45a7",
          "display": "shared/schema.ts:10"
        }
      ]
    },
    "limitations": [
      "No direct evidence for non-Replit or containerized deployment process.",
      "No explicit persistent log storage path or rotation confirmed.",
      "Outbound integration/webhook support couldn't be confirmed."
    ]
  },
  "completeness": {
    "score": 85,
    "max": 100,
    "missing": [],
    "deductions": [
      "-15 for 6 unknown(s)"
    ],
    "notes": "-15 for 6 unknown(s); 6 unknown(s) reported"
  }
}