{
  "prereqs": [
    "Node.js 20+ (for server and frontend, .replit:1, replit.md:41, README.md:24)",
    "npm (package manager, implied by Node/npm usage; .replit:2, package.json:1; replit.md:41)",
    "PostgreSQL 14+ (database, .replit:1, replit.md:66, README.md:24)",
    "Python 3.11+ (for analyzer CLI, .replit:1, pyproject.toml:5, replit.md:41)",
    "jq, unzip (ops scripts, .replit:7, docs/dossiers/lantern_program_totality_dossier.md:81, README.md:34)",
    "TypeScript (dev/build, package.json:82, replit.md:82)",
    "tsx (development, package.json:82, replit.md:82)",
    "drizzle-kit (migrations, package.json:99, replit.md:82)"
  ],
  "install_steps": [
    {
      "step": "Clone the repository",
      "command": "git clone <repo_url>",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 86,
        "line_end": 86,
        "snippet_hash": "af4db2203afc",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:86"
      }
    },
    {
      "step": "Install Node.js dependencies",
      "command": "npm install",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 87,
        "line_end": 88,
        "snippet_hash": "4e60fcc46ada",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:87-88"
      }
    },
    {
      "step": "Copy environment variable template",
      "command": "cp .env.example .env",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 89,
        "line_end": 89,
        "snippet_hash": "232f2a0c483a",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:89"
      }
    },
    {
      "step": "Edit .env and set variables",
      "command": "nano .env",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 91,
        "line_end": 92,
        "snippet_hash": "ff28a61c3197",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:91-92"
      }
    },
    {
      "step": "Initialize Python CLI tool (optional, for analyzer): pip install -e .",
      "command": "pip install -e .",
      "evidence": {
        "path": "README.md",
        "line_start": 22,
        "line_end": 22,
        "snippet_hash": "92755120ac2c",
        "display": "README.md:22"
      }
    },
    {
      "step": "Install Python dependencies",
      "command": "pip install -e .",
      "evidence": {
        "path": "pyproject.toml",
        "line_start": 6,
        "line_end": 6,
        "snippet_hash": "be2039d702c1",
        "display": "pyproject.toml:6"
      }
    }
  ],
  "config": [
    {
      "name": "DATABASE_URL",
      "purpose": "PostgreSQL connection string, required for database connectivity",
      "evidence": {
        "path": "drizzle.config.ts",
        "line_start": 3,
        "line_end": 3,
        "snippet_hash": "a19790628fbe",
        "display": "drizzle.config.ts:3"
      }
    },
    {
      "name": "API_KEY",
      "purpose": "API key for authenticating to private endpoints",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 100,
        "line_end": 100,
        "snippet_hash": "24b9d5caf118",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:100"
      }
    },
    {
      "name": "SESSION_SECRET",
      "purpose": "Session secret for express-session; must be a strong, random string",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 101,
        "line_end": 101,
        "snippet_hash": "62fec4db8fd5",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:101"
      }
    },
    {
      "name": "NODE_ENV",
      "purpose": "Sets environment to development or production",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 102,
        "line_end": 102,
        "snippet_hash": "27cb50caf049",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:102"
      }
    },
    {
      "name": "PORT",
      "purpose": "Port server listens on (default 5000)",
      "evidence": ".env.example:14, .replit:14, docs/dossiers/lantern_program_totality_dossier.md:103"
    },
    {
      "name": "AI_INTEGRATIONS_OPENAI_API_KEY",
      "purpose": "OpenAI API key for LLM-powered analysis and AI integrations",
      "evidence": {
        "path": "replit.md",
        "line_start": 102,
        "line_end": 102,
        "snippet_hash": "9a7243284b61",
        "display": "replit.md:102"
      }
    },
    {
      "name": "AI_INTEGRATIONS_OPENAI_BASE_URL",
      "purpose": "Base URL for OpenAI API",
      "evidence": {
        "path": "replit.md",
        "line_start": 103,
        "line_end": 103,
        "snippet_hash": "74446865b626",
        "display": "replit.md:103"
      }
    }
  ],
  "run_dev": [
    {
      "step": "Start development server",
      "command": "npm run dev",
      "evidence": {
        "path": ".replit",
        "line_start": 2,
        "line_end": 2,
        "snippet_hash": "96fa2e5505e4",
        "display": ".replit:2"
      }
    }
  ],
  "run_prod": [
    {
      "step": "Build frontend and backend for production",
      "command": "npm run build",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 119,
        "line_end": 119,
        "snippet_hash": "4124e323d038",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:119"
      }
    },
    {
      "step": "Start production server",
      "command": "NODE_ENV=production npm run start",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 122,
        "line_end": 122,
        "snippet_hash": "519534c1f466",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:122"
      }
    }
  ],
  "usage_examples": [
    {
      "description": "Health check endpoint",
      "command": "curl http://localhost:5000/api/health"
    },
    {
      "description": "Readiness endpoint",
      "command": "curl http://localhost:5000/api/ready"
    },
    {
      "description": "Verify audit log",
      "command": "curl -H \"x-api-key: <API_KEY>\" http://localhost:5000/api/audit/verify"
    },
    {
      "description": "Export forensic pack",
      "command": "npx tsx scripts/export_forensic_pack.ts --output <pack.json>"
    },
    {
      "description": "Offline verify forensic pack",
      "command": "npx tsx scripts/verify_forensic_pack.ts <pack.json>"
    },
    {
      "description": "Python CLI usage: analyze Replit workspace",
      "command": "pta analyze --replit -o ./output"
    }
  ],
  "verification_steps": [
    {
      "step": "Check database migrations/sync",
      "command": "npm run db:push",
      "evidence": {
        "path": "package.json",
        "line_start": 11,
        "line_end": 11,
        "snippet_hash": "3a8be55004c2",
        "display": "package.json:11"
      }
    },
    {
      "step": "Verify audit chain",
      "command": "curl -H \"x-api-key: <API_KEY>\" http://localhost:5000/api/audit/verify",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 140,
        "line_end": 140,
        "snippet_hash": "66a8604b5116",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:140"
      }
    },
    {
      "step": "Export forensic pack",
      "command": "npx tsx scripts/export_forensic_pack.ts --output <pack.json>",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 142,
        "line_end": 142,
        "snippet_hash": "1694391fc721",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:142"
      }
    },
    {
      "step": "Offline verify forensic pack",
      "command": "npx tsx scripts/verify_forensic_pack.ts <pack.json>",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 144,
        "line_end": 144,
        "snippet_hash": "1d2e07b09d7a",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:144"
      }
    },
    {
      "step": "Run smoke test (verifies all Python/CLI entry methods and deterministic output)",
      "command": "bash scripts/smoke_test.sh",
      "evidence": {
        "path": "attached_assets/Pasted-Got-it-Copilot-said-it-did-it-but-you-need-reproducible_1771067676312.txt",
        "line_start": 195,
        "line_end": 195,
        "snippet_hash": "f1b901847390",
        "display": "attached_assets/Pasted-Got-it-Copilot-said-it-did-it-but-you-need-reproducible_1771067676312.txt:195"
      }
    }
  ],
  "common_failures": [
    {
      "symptom": "401 Unauthorized",
      "cause": "Wrong or missing API_KEY in request",
      "fix": "Set correct x-api-key header, check .env",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 151,
        "line_end": 151,
        "snippet_hash": "ab249b766ec2",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:151"
      }
    },
    {
      "symptom": "DB connection errors/crash",
      "cause": "Bad DATABASE_URL, DB offline, wrong credentials, or version",
      "fix": "Check credentials, DB service is running and version >= 14",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 152,
        "line_end": 152,
        "snippet_hash": "7b577da63c45",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:152"
      }
    },
    {
      "symptom": "Server not running on port",
      "cause": "App not started, port conflict",
      "fix": "Check logs, verify PORT=5000, ensure port is not already used",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 153,
        "line_end": 153,
        "snippet_hash": "6bfea429a287",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:153"
      }
    },
    {
      "symptom": "Forensic pack tamper undetected",
      "cause": "Bug in or missing script for verification",
      "fix": "Re-export pack, ensure proper verification script installed/runs",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 154,
        "line_end": 154,
        "snippet_hash": "bce1008b2a9d",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:154"
      }
    }
  ],
  "unknowns": [
    {
      "what_is_missing": "Production deployment methods outside Replit (e.g., Docker/systemd/PM2)",
      "why_it_matters": "Required for ops on real-world/non-Replit platforms",
      "what_evidence_needed": "Dockerfile, systemd unit, or production ops deployment documentation"
    },
    {
      "what_is_missing": "Database initialization beyond drizzle-kit",
      "why_it_matters": "May impact custom DB/user privilege requirements and stateful setups",
      "what_evidence_needed": "Database schema DDL, role guides, SQL init instructions"
    },
    {
      "what_is_missing": "API_KEY or SESSION_SECRET rotation/generation procedure",
      "why_it_matters": "Required for secure long-term operation and secops hygiene",
      "what_evidence_needed": "Documented step-by-step key rotation/management instructions"
    },
    {
      "what_is_missing": "Log file paths or operator access/viewing commands",
      "why_it_matters": "Critical for troubleshooting and operations support",
      "what_evidence_needed": "Log file locations or sample tail/inspection commands"
    },
    {
      "what_is_missing": "Standalone frontend build/hosting commands for non-Replit/split hosting",
      "why_it_matters": "Important if serving frontend from a different host/platform",
      "what_evidence_needed": "Manual or scripts describing only frontend build/host process"
    },
    {
      "what_is_missing": "Outbound webhook/integration points",
      "why_it_matters": "For connecting to SIEM, alerting systems, or integrations",
      "what_evidence_needed": "Example config, documentation, or code for outbound webhooks/push"
    }
  ],
  "missing_evidence_requests": [
    "Production deployment process details for non-Replit (Dockerfile, systemd, etc.)",
    "Database initialization and privilege setup beyond drizzle-kit",
    "Procedure for key rotation (API_KEY, SESSION_SECRET)",
    "Explicit log file storage/view commands",
    "Standalone frontend deployment steps",
    "Webhook/integration setup documentation"
  ],
  "replit_execution_profile": {
    "run_command": "npm run dev",
    "language": "nodejs",
    "port_binding": {
      "port": null,
      "binds_all_interfaces": true,
      "uses_env_port": true,
      "evidence": [
        {
          "path": "server/index.ts",
          "line_start": 92,
          "line_end": 92,
          "snippet_hash": "75d345a78f84",
          "display": "server/index.ts:92"
        },
        {
          "path": "server/index.ts",
          "line_start": 96,
          "line_end": 96,
          "snippet_hash": "9b7206f3d09a",
          "display": "server/index.ts:96"
        }
      ]
    },
    "required_secrets": [
      {
        "name": "DATABASE_URL",
        "referenced_in": [
          {
            "path": "drizzle.config.ts",
            "line_start": 3,
            "line_end": 3,
            "snippet_hash": "a19790628fbe",
            "display": "drizzle.config.ts:3"
          },
          {
            "path": "drizzle.config.ts",
            "line_start": 12,
            "line_end": 12,
            "snippet_hash": "1005be19f14a",
            "display": "drizzle.config.ts:12"
          },
          {
            "path": "server/db.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "a19790628fbe",
            "display": "server/db.ts:7"
          },
          {
            "path": "server/db.ts",
            "line_start": 13,
            "line_end": 13,
            "snippet_hash": "111f33de9945",
            "display": "server/db.ts:13"
          }
        ]
      },
      {
        "name": "AI_INTEGRATIONS_OPENAI_API_KEY",
        "referenced_in": [
          {
            "path": "server/replit_integrations/audio/client.ts",
            "line_start": 10,
            "line_end": 10,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/audio/client.ts:10"
          },
          {
            "path": "server/replit_integrations/chat/routes.ts",
            "line_start": 6,
            "line_end": 6,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/chat/routes.ts:6"
          },
          {
            "path": "server/replit_integrations/image/client.ts",
            "line_start": 6,
            "line_end": 6,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/image/client.ts:6"
          }
        ]
      },
      {
        "name": "AI_INTEGRATIONS_OPENAI_BASE_URL",
        "referenced_in": [
          {
            "path": "server/replit_integrations/audio/client.ts",
            "line_start": 11,
            "line_end": 11,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/audio/client.ts:11"
          },
          {
            "path": "server/replit_integrations/chat/routes.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/chat/routes.ts:7"
          },
          {
            "path": "server/replit_integrations/image/client.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/image/client.ts:7"
          }
        ]
      }
    ],
    "external_apis": [
      {
        "api": "OpenAI",
        "evidence_files": [
          "server/replit_integrations/audio/client.ts:1",
          "server/replit_integrations/audio/routes.ts:3",
          "server/replit_integrations/chat/routes.ts:2",
          "server/replit_integrations/image/routes.ts:2",
          "server/replit_integrations/image/client.ts:2"
        ]
      }
    ],
    "deployment_assumptions": [
      "Binds to 0.0.0.0 (all interfaces)",
      "No Dockerfile - depends on Replit runtime or manual setup",
      "Requires 3 secret(s): DATABASE_URL, AI_INTEGRATIONS_OPENAI_API_KEY, AI_INTEGRATIONS_OPENAI_BASE_URL"
    ],
    "observability": {
      "logging": true,
      "health_endpoint": true,
      "evidence": [
        {
          "path": "script/build.ts",
          "line_start": 38,
          "line_end": 38,
          "snippet_hash": "2f74cc3fdab1",
          "display": "script/build.ts:38"
        },
        {
          "path": "shared/schema.ts",
          "line_start": 10,
          "line_end": 10,
          "snippet_hash": "6ccc8e5d45a7",
          "display": "shared/schema.ts:10"
        }
      ]
    },
    "limitations": [
      "Entrypoint file for Node.js could not be directly inferred (null in profile, .replit run points to npm script)",
      "No explicit evidence for log viewing/inspection commands",
      "No evidence for outbound webhook or split frontend hosting steps"
    ]
  },
  "completeness": {
    "score": 85,
    "max": 100,
    "missing": [],
    "deductions": [
      "-15 for 6 unknown(s)"
    ],
    "notes": "-15 for 6 unknown(s); No Dockerfile found; 6 unknown(s) reported"
  }
}