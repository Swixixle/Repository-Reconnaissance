That message you pasted reads like an agent “stream of actions,” but **it’s not grounded** unless those code changes actually exist in your Replit workspace right now. I’m going to treat it as **a plan / claimed completion**, and give you **exact agent instructions** to (a) implement Replit-mode correctly, and (b) verify it with deterministic checks.

Below is what you should paste to your Replit agents **right now** to force correctness and stop “hand-wave completion.”

---

# REPLIT AGENTS — REPLIT MODE IMPLEMENTATION + VERIFICATION (HARD CHECKLIST)

## Ground rule

Do **not** claim “done” unless you can show:

* file paths changed
* the CLI runs successfully
* the outputs contain a **Replit Execution Profile** section
* evidence citations are present

No “the app is running” statements without proof.

---

## 0) Confirm what project we’re in

Before doing anything, print:

* the repository file tree (top 2 levels)
* whether this is CLI-only or already has a web UI + API routes

Command:

```bash
pwd
ls
find . -maxdepth 2 -type f | sort
```

If this is CLI-only, **do not invent frontend/backend routes**. Implement Replit mode in CLI first.

---

## 1) Add 3 input modes (GitHub / local / Replit workspace)

### CLI contract (must exist)

`analyzer_cli.py` must support:

```bash
python analyzer_cli.py analyze <target>
python analyzer_cli.py analyze <local_path>
python analyzer_cli.py analyze --replit
```

Rules:

* If `--replit` is set, ignore `<target>` and set root = current working directory.
* If `<target>` starts with `http` and contains `github.com`, treat as GitHub.
* Else if `<target>` is a path, treat as local folder.

Implement this in `src/core/acquire.py`:

* `acquire_target(target: Optional[str], replit_mode: bool) -> AcquireResult`
* AcquireResult must include: `root_path`, `mode`, `source_ref`, `run_id`

---

## 2) Replit-aware evidence extraction (static only)

### New: Replit detector

Implement `src/core/replit_profile.py` and call it from extraction.

It must:

* Detect `.replit` and parse run command
* Detect `replit.nix` and list packages (simple parse is OK)
* Detect port assumptions by scanning for:

  * `PORT` env usage
  * `process.env.PORT`
  * `0.0.0.0`
  * common defaults (`5000`, `3000`, `8080`)
* Detect “expected secrets” by scanning for `os.environ[...]`, `process.env.X`, `dotenv`, etc.

  * Only output env var **names** (never values)
* Output a `replit_profile.json` (in the run folder)

Add to run output:

```
out/<run_id>/replit_profile.json
```

---

## 3) “How to use the TARGET system” must include Replit instructions

Update `target_howto.json` generation:

If mode == `replit`, the “How to Use the Target System” section must contain:

* **Run in Replit**: “Press Run → executes: <run command from .replit>”
* **Secrets required**: list of env var names referenced
* **Port binding**: inferred port behavior + evidence
* **Runtime**: inferred from `.replit` + manifests + nix
* **Limitations**: if missing, say unknown

Everything must cite evidence:

* `.replit` lines
* `replit.nix` lines
* code references for env vars / ports

---

## 4) Fix the earlier agent drift: no phantom web UI

Unless the project already contains a frontend/backend:

* DO NOT add “routes,” “hooks,” “buttons,” “project list,” etc.

Those claims are invalid unless the repo is a web app.
This analyzer V1 is CLI-first.

If there *is* a web app already, then:

* show the existing backend route files before modifying anything
* add endpoints only after CLI works

---

## 5) Skeptic enforcement must apply to “how-to” steps

If any how-to step is not supported by evidence:

* mark as `unknown`
* add to `missing_evidence_requests`
* cap confidence at 0.20

This includes Replit-specific steps.

---

## 6) Verification steps (MANDATORY)

After implementation, run these tests and show outputs:

### Test A: Analyze current workspace (Replit mode)

```bash
python analyzer_cli.py analyze --replit
```

Confirm the run folder contains:

* `DOSSIER.md`
* `target_howto.json`
* `replit_profile.json`
* packs

Confirm DOSSIER includes:

* “How to Use the Target System”
* “Replit Execution Profile” (subsection inside How-To or Ops)

### Test B: Analyze local folder mode

Create a tiny folder:

```bash
mkdir -p /tmp/miniapp
cat >/tmp/miniapp/README.md <<'EOF'
# MiniApp
Run:
python app.py
EOF
cat >/tmp/miniapp/app.py <<'EOF'
print("hi")
EOF
python analyzer_cli.py analyze /tmp/miniapp
```

Ensure how-to reflects `python app.py` with evidence.

### Test C: Analyze GitHub public repo

Pick a tiny public repo (not huge). Run:

```bash
python analyzer_cli.py analyze https://github.com/<owner>/<repo>
```

---

## 7) Deliverables to report back

Post back:

1. The updated file tree (top 3 levels)
2. The exact CLI help output (`python analyzer_cli.py --help`)
3. A snippet of DOSSIER “How to Use the Target System” section from Replit-mode run
4. The `replit_profile.json` content (redact nothing sensitive; it should contain only names)

---

# IMPORTANT: Reality check on the message you pasted

That earlier “I updated routes / frontend / storage…” is **not acceptable** unless those files exist and were changed.

This project is CLI-first. We build correctness and evidence discipline before UI.

Proceed accordingly.

---

If you paste the agents’ returned file tree + the first DOSSIER “How to Use” section here, I’ll do an architect-grade review and tell you exactly what to tighten next (especially around “how-to evidence” and port/secrets inference).
