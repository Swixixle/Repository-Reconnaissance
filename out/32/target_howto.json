{
  "prereqs": [
    "Node.js 20+",
    {
      "evidence": "replit.md:79"
    },
    "npm",
    {
      "evidence": "replit.md:79"
    },
    "PostgreSQL 14+",
    {
      "evidence": "replit.md:80"
    },
    "jq",
    {
      "evidence": ".replit:7"
    },
    "unzip",
    {
      "evidence": ".replit:7"
    },
    "python3 >=3.11",
    {
      "evidence": "pyproject.toml:5"
    },
    "TypeScript",
    {
      "evidence": "package.json:104"
    },
    "tsx",
    {
      "evidence": "package.json:103"
    },
    "drizzle-kit",
    {
      "evidence": "package.json:99"
    }
  ],
  "install_steps": [
    {
      "step": "Clone repository",
      "command": null,
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 86,
        "line_end": 86,
        "snippet_hash": "af4db2203afc",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:86"
      }
    },
    {
      "step": "Install Node.js dependencies",
      "command": "npm install",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 87,
        "line_end": 87,
        "snippet_hash": "cf084566c05c",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:87"
      }
    },
    {
      "step": "Copy .env file",
      "command": "cp .env.example .env",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 89,
        "line_end": 89,
        "snippet_hash": "232f2a0c483a",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:89"
      }
    },
    {
      "step": "Install Python dependencies",
      "command": "pip install -e .",
      "evidence": {
        "path": "README.md",
        "line_start": 25,
        "line_end": 25,
        "snippet_hash": "92755120ac2c",
        "display": "README.md:25"
      }
    }
  ],
  "config": [
    {
      "name": "DATABASE_URL",
      "purpose": "PostgreSQL connection string",
      "evidence": {
        "path": "drizzle.config.ts",
        "line_start": 3,
        "line_end": 3,
        "snippet_hash": "a19790628fbe",
        "display": "drizzle.config.ts:3"
      }
    },
    {
      "name": "ADMIN_KEY",
      "purpose": "Admin API key required for private endpoints",
      "evidence": {
        "path": "server/routes.ts",
        "line_start": 34,
        "line_end": 34,
        "snippet_hash": "e2bf4a7a579d",
        "display": "server/routes.ts:34"
      }
    },
    {
      "name": "AI_INTEGRATIONS_OPENAI_API_KEY",
      "purpose": "OpenAI API Key for LLM-powered features",
      "evidence": {
        "path": "server/replit_integrations/audio/client.ts",
        "line_start": 10,
        "line_end": 10,
        "snippet_hash": "05da5f1b1281",
        "display": "server/replit_integrations/audio/client.ts:10"
      }
    },
    {
      "name": "AI_INTEGRATIONS_OPENAI_BASE_URL",
      "purpose": "Base URL for OpenAI API integration",
      "evidence": {
        "path": "server/replit_integrations/audio/client.ts",
        "line_start": 11,
        "line_end": 11,
        "snippet_hash": "1f70e6a77d42",
        "display": "server/replit_integrations/audio/client.ts:11"
      }
    },
    {
      "name": "ANALYZER_TIMEOUT_MS",
      "purpose": "Controls Python analyzer timeout",
      "evidence": {
        "path": "server/routes.ts",
        "line_start": 243,
        "line_end": 243,
        "snippet_hash": "76e1b5bb0c59",
        "display": "server/routes.ts:243"
      }
    }
  ],
  "run_dev": [
    {
      "step": "Run development server (Node.js/Express + React/Vite)",
      "command": "npm run dev",
      "evidence": {
        "path": ".replit",
        "line_start": 2,
        "line_end": 2,
        "snippet_hash": "96fa2e5505e4",
        "display": ".replit:2"
      }
    }
  ],
  "run_prod": [
    {
      "step": "Build project for production",
      "command": "npm run build",
      "evidence": {
        "path": "package.json",
        "line_start": 8,
        "line_end": 8,
        "snippet_hash": "79d8bdf275d6",
        "display": "package.json:8"
      }
    },
    {
      "step": "Start production server",
      "command": "npm run start",
      "evidence": {
        "path": "package.json",
        "line_start": 9,
        "line_end": 9,
        "snippet_hash": "020435ddf436",
        "display": "package.json:9"
      }
    }
  ],
  "usage_examples": [
    {
      "description": "Check system health endpoint",
      "command": "curl http://localhost:5000/api/health"
    },
    {
      "description": "Check readiness endpoint",
      "command": "curl http://localhost:5000/api/ready"
    },
    {
      "description": "Verify audit chain (requires API_KEY)",
      "command": "curl -H \"x-api-key: <API_KEY>\" http://localhost:5000/api/audit/verify"
    },
    {
      "description": "Export forensic pack",
      "command": "npx tsx scripts/export_forensic_pack.ts --output <pack.json>"
    },
    {
      "description": "Offline verify forensic pack",
      "command": "npx tsx scripts/verify_forensic_pack.ts <pack.json>"
    }
  ],
  "verification_steps": [
    {
      "step": "Verify Node application is running (dev mode)",
      "command": "curl http://localhost:5000/api/health",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 128,
        "line_end": 128,
        "snippet_hash": "4994405dd75c",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:128"
      }
    },
    {
      "step": "Apply database schema",
      "command": "npm run db:push",
      "evidence": {
        "path": "package.json",
        "line_start": 11,
        "line_end": 11,
        "snippet_hash": "3a8be55004c2",
        "display": "package.json:11"
      }
    },
    {
      "step": "Run Python analyzer CLI (deterministic, self-test)",
      "command": "bash scripts/smoke_test.sh",
      "evidence": {
        "path": "README.md",
        "line_start": 225,
        "line_end": 225,
        "snippet_hash": "46effdb3adbb",
        "display": "README.md:225"
      }
    }
  ],
  "common_failures": [
    {
      "symptom": "401 Unauthorized API calls",
      "cause": "Wrong/missing API_KEY header",
      "fix": "Set correct x-api-key header and check .env",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 151,
        "line_end": 151,
        "snippet_hash": "ab249b766ec2",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:151"
      }
    },
    {
      "symptom": "DB connection errors/crash",
      "cause": "Invalid DATABASE_URL, database offline/wrong",
      "fix": "Check credentials, DB service status, version",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 152,
        "line_end": 152,
        "snippet_hash": "7b577da63c45",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:152"
      }
    },
    {
      "symptom": "Server not running on port",
      "cause": "App not started or port conflict",
      "fix": "Check logs and ensure PORT=5000 is available",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 153,
        "line_end": 153,
        "snippet_hash": "6bfea429a287",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:153"
      }
    },
    {
      "symptom": "Forensic pack tamper undetected",
      "cause": "Bug or missing verification script",
      "fix": "Re-export pack and ensure correct script is installed",
      "evidence": {
        "path": "docs/dossiers/lantern_program_totality_dossier.md",
        "line_start": 154,
        "line_end": 154,
        "snippet_hash": "bce1008b2a9d",
        "display": "docs/dossiers/lantern_program_totality_dossier.md:154"
      }
    }
  ],
  "unknowns": [
    {
      "what_is_missing": "Standalone frontend build/launch instructions for non-Replit production",
      "why_it_matters": "Operators may need to deploy frontend separately or to non-Replit environments",
      "what_evidence_needed": "Explicit production build/start steps for frontend (e.g., Vite output hosting), reverse proxy/Docker config"
    },
    {
      "what_is_missing": "Log viewing/storage location or commands",
      "why_it_matters": "Operational troubleshooting and support relies on finding logs",
      "what_evidence_needed": "Log file/documentation or example tail/grep commands"
    },
    {
      "what_is_missing": "Webhooks or outbound integration details",
      "why_it_matters": "Critical for integration with alerting/monitoring systems",
      "what_evidence_needed": "Explicit webhook/config file or sample config"
    },
    {
      "what_is_missing": "Key rotation/generation procedures for API_KEY or SESSION_SECRET",
      "why_it_matters": "Lifecycle management and long-term operation",
      "what_evidence_needed": "Operational procedure documentation"
    },
    {
      "what_is_missing": "Production deployment details for Docker/systemd/PM2 etc.",
      "why_it_matters": "Required for platform-native deployment outside Replit",
      "what_evidence_needed": "Systemd unit, Dockerfile evidence of use, or process manager config"
    }
  ],
  "missing_evidence_requests": [
    "Standalone frontend hosting/run command for production",
    "Log viewing/storage documentation or commands",
    "Webhook configuration or sample",
    "Key rotation/generation operational procedure",
    "External (non-Replit) deployment configuration (Docker, systemd, etc)"
  ],
  "replit_execution_profile": {
    "run_command": "npm run dev",
    "language": "nodejs",
    "port_binding": {
      "port": null,
      "binds_all_interfaces": true,
      "uses_env_port": true,
      "evidence": [
        {
          "path": "server/index.ts",
          "line_start": 92,
          "line_end": 92,
          "snippet_hash": "75d345a78f84",
          "display": "server/index.ts:92"
        },
        {
          "path": "server/index.ts",
          "line_start": 96,
          "line_end": 96,
          "snippet_hash": "9b7206f3d09a",
          "display": "server/index.ts:96"
        }
      ]
    },
    "required_secrets": [
      {
        "name": "DATABASE_URL",
        "referenced_in": [
          {
            "path": "drizzle.config.ts",
            "line_start": 3,
            "line_end": 3,
            "snippet_hash": "a19790628fbe",
            "display": "drizzle.config.ts:3"
          },
          {
            "path": "drizzle.config.ts",
            "line_start": 12,
            "line_end": 12,
            "snippet_hash": "1005be19f14a",
            "display": "drizzle.config.ts:12"
          },
          {
            "path": "server/db.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "a19790628fbe",
            "display": "server/db.ts:7"
          },
          {
            "path": "server/db.ts",
            "line_start": 13,
            "line_end": 13,
            "snippet_hash": "111f33de9945",
            "display": "server/db.ts:13"
          }
        ]
      },
      {
        "name": "ADMIN_KEY",
        "referenced_in": [
          {
            "path": "server/routes.ts",
            "line_start": 34,
            "line_end": 34,
            "snippet_hash": "e2bf4a7a579d",
            "display": "server/routes.ts:34"
          }
        ]
      },
      {
        "name": "ANALYZER_TIMEOUT_MS",
        "referenced_in": [
          {
            "path": "server/routes.ts",
            "line_start": 243,
            "line_end": 243,
            "snippet_hash": "76e1b5bb0c59",
            "display": "server/routes.ts:243"
          }
        ]
      },
      {
        "name": "AI_INTEGRATIONS_OPENAI_API_KEY",
        "referenced_in": [
          {
            "path": "server/replit_integrations/audio/client.ts",
            "line_start": 10,
            "line_end": 10,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/audio/client.ts:10"
          },
          {
            "path": "server/replit_integrations/chat/routes.ts",
            "line_start": 6,
            "line_end": 6,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/chat/routes.ts:6"
          },
          {
            "path": "server/replit_integrations/image/client.ts",
            "line_start": 6,
            "line_end": 6,
            "snippet_hash": "05da5f1b1281",
            "display": "server/replit_integrations/image/client.ts:6"
          }
        ]
      },
      {
        "name": "AI_INTEGRATIONS_OPENAI_BASE_URL",
        "referenced_in": [
          {
            "path": "server/replit_integrations/audio/client.ts",
            "line_start": 11,
            "line_end": 11,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/audio/client.ts:11"
          },
          {
            "path": "server/replit_integrations/chat/routes.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/chat/routes.ts:7"
          },
          {
            "path": "server/replit_integrations/image/client.ts",
            "line_start": 7,
            "line_end": 7,
            "snippet_hash": "1f70e6a77d42",
            "display": "server/replit_integrations/image/client.ts:7"
          }
        ]
      }
    ],
    "external_apis": [
      {
        "api": "OpenAI",
        "evidence_files": [
          "server/replit_integrations/audio/client.ts:1",
          "server/replit_integrations/audio/routes.ts:3",
          "server/replit_integrations/chat/routes.ts:2",
          "server/replit_integrations/image/routes.ts:2",
          "server/replit_integrations/image/client.ts:2"
        ]
      }
    ],
    "deployment_assumptions": [
      "Binds to 0.0.0.0 (all interfaces)",
      "Requires 5 secret(s): DATABASE_URL, ADMIN_KEY, ANALYZER_TIMEOUT_MS, AI_INTEGRATIONS_OPENAI_API_KEY, AI_INTEGRATIONS_OPENAI_BASE_URL"
    ],
    "observability": {
      "logging": true,
      "health_endpoint": true,
      "evidence": [
        {
          "path": "script/build.ts",
          "line_start": 38,
          "line_end": 38,
          "snippet_hash": "2f74cc3fdab1",
          "display": "script/build.ts:38"
        },
        {
          "path": "server/routes.ts",
          "line_start": 55,
          "line_end": 55,
          "snippet_hash": "f7ba68760271",
          "display": "server/routes.ts:55"
        },
        {
          "path": "shared/schema.ts",
          "line_start": 10,
          "line_end": 10,
          "snippet_hash": "6ccc8e5d45a7",
          "display": "shared/schema.ts:10"
        }
      ]
    },
    "limitations": [
      "Cannot determine explicit log file location or viewing command",
      "No explicit evidence for how to deploy outside Replit/Node runtime (e.g. PM2/systemd)",
      "Cannot determine webhook/event integration endpoints from evidence",
      "Cannot determine key rotation procedures from evidence"
    ]
  },
  "completeness": {
    "score": 85,
    "max": 100,
    "missing": [],
    "deductions": [
      "-15 for 5 unknown(s)"
    ],
    "notes": "-15 for 5 unknown(s); 5 unknown(s) reported"
  }
}