
--- FILE: README.md ---
L1: # prompt-box (pb)
L2: 
L3: A safety-first command gate for pasted terminal commands.
L4: 
L5: ## What it does
L6: - Reads commands from stdin (or clipboard via `pb clip`)
L7: - Classifies each command: ALLOW / REVIEW / BLOCK
L8: - Shows a plan
L9: - Optionally runs only ALLOW commands after you type YES
L10: 
L11: ## Install (local)
L12: cd ~/prompt-box
L13: chmod +x pb
L14: sudo ln -sf "$(pwd)/pb" /usr/local/bin/pb
L15: 
L16: ## Usage
L17: printf "pwd\nls -la\n" | pb check
L18: printf "pwd\nls -la\n" | pb run
L19: 
L20: ## Security guarantees
L21: - No shell=True
L22: - Uses shlex.split
L23: - No implicit pipes, redirects, or globbing

--- FILE: SECURITY.md ---
L1: # Security Model â€” prompt-box (pb)
L2: 
L3: ## Execution Safety
L4: `pb` is designed to safely inspect and optionally execute shell commands provided via stdin or clipboard.
L5: 
L6: ### Key Guarantees
L7: - **No shell interpolation**
L8:   - All commands are executed with `shell=False`
L9:   - Arguments are parsed using `shlex.split()`
L10: - **Explicit user consent**
L11:   - `pb run` requires typing `YES` in an interactive terminal
L12: - **Allowlist-first model**
L13:   - Commands are classified as ALLOW / REVIEW / BLOCK before execution
L14:   - Only ALLOW commands may run
L15: - **No implicit pipes, redirects, or globbing**
L16:   - Characters like `|`, `>`, `*`, `&&` are not interpreted by a shell
L17: 
L18: ### Why this matters
L19: This design prevents:
L20: - Shell injection
L21: - Accidental execution of pasted malicious commands
L22: - Hidden side effects from pipes or redirects
L23: 
L24: ### Audit Trail
L25: - Every execution produces a JSON receipt in `receipts/`
L26: - Receipts are intentionally excluded from version control
L27: 
L28: ## Threat Model Notes
L29: If future versions add:
L30: - pipes (`|`)
L31: - redirects (`>`, `<`)
L32: - glob expansion (`*`)
L33: these **must be parsed explicitly**, not passed to a shell.
L34: 
L35: Shell execution (`shell=True`) is intentionally forbidden.
