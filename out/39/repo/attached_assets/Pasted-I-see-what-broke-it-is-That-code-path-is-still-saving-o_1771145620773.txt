I see what “broke it” is.

That code path is **still saving only the old artifacts**:

* `DOSSIER.md`
* `claims.json`
* `target_howto.json`
* `coverage.json`

…but it **does not read or persist `operate.json`**.

So if your UI/Dashboard expects `operate` (or your API started returning it), you’ll get null/undefined behavior and the app feels “broken.”

You don’t need a redesign. You need a **single plumbing patch**.

---

# The Fix (surgical)

## 1) Find the exact file in *your repo* that contains this block

In Replit Shell:

```bash
grep -R "target_howto.json" -n server | head -n 20
```

That will show you the real path (likely a job runner / queue worker / route handler).

Open that file and patch the “read results” section.

---

## 2) Patch: read `operate.json` and store it

Right now you have:

```ts
const howtoPath = path.join(outputDir, "target_howto.json");
...
const howto = JSON.parse(await fs.readFile(howtoPath, "utf-8").catch(() => "{}"));
...
await storage.createAnalysis({
  projectId,
  dossier,
  claims,
  howto,
  coverage,
  unknowns: howto.unknowns || [],
});
```

### Replace/add these lines:

```ts
const operatePath = path.join(outputDir, "operate.json");

const operate = JSON.parse(
  await fs.readFile(operatePath, "utf-8").catch(() => "{}")
);
```

…and include it in `createAnalysis`:

```ts
await storage.createAnalysis({
  projectId,
  dossier,
  claims,
  howto,
  operate,
  coverage,
  unknowns: howto.unknowns || [],
});
```

That alone stops the “Dashboard has no data” problem.

---

## 3) Ensure the DB/storage layer supports it

### A) Search where `createAnalysis` is defined

```bash
grep -R "createAnalysis" -n server | head -n 50
```

You need:

* DB schema includes an `operate` JSON column
* the insert query includes it

If schema already has it, confirm the insert includes it.

### B) Quick schema check (Drizzle/etc.)

Search for `operate` in schema:

```bash
grep -R "operate" -n server | head -n 50
```

If you *don’t* have an `operate` column, add it as JSON/JSONB, matching how `claims/howto/coverage` are stored.

---

## 4) Make the API return `operate`

Wherever you have an endpoint like:

* `GET /api/analyses/:id`
* `GET /api/projects/:id` returning analysis payload

Make sure it includes `operate` in the JSON response.

Search:

```bash
grep -R "howto" -n server | head -n 50
```

…and add `operate` wherever `howto` is returned.

---

## 5) Frontend safety: treat operate as optional

Even after you fix persistence, old analyses won’t have `operate`.

So the dashboard component must do:

* `const operate = analysis.operate ?? null`
* render a “No operate data available (run analysis again)” empty state

That prevents crashes.

---

# Why this happened (clean explanation)

You upgraded PTA to produce `operate.json`, but your **orchestrator** (the Node code that runs PTA and saves results) still thinks the world ends at `target_howto.json`.

So the analyzer is generating the file correctly, but the app is **dropping it on the floor**.

---

# One command that will confirm the fix immediately

After patching, run one analysis and then inspect the saved DB record / API response:

* If you have an API endpoint returning analysis JSON, hit it and confirm `operate` exists.
* Or temporarily add a log right after `operate` parse:

```ts
console.log("operate keys:", Object.keys(operate || {}));
```

---

If you paste the output of:

```bash
grep -R "target_howto.json" -n server | head -n 20
```

…I’ll tell you the exact file to edit and the exact minimal diff for *your* repo structure (no guessing).
