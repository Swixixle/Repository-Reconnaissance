{
  "evidence_pack_version": "1.0",
  "tool_version": "0.1.0",
  "generated_at": "2026-02-15T11:10:28.913160+00:00",
  "mode": "github",
  "run_id": "5b0cc16b4179",
  "verified": {
    "Architecture Snapshot": [
      {
        "id": "claim_001",
        "statement": "The frontend is implemented as a React 18 Single-Page Application using TypeScript, Wouter for routing, and shadcn/ui with Tailwind and Framer Motion for the UI.",
        "section": "Architecture Snapshot",
        "evidence": [
          {
            "path": "replit.md",
            "line_start": 21,
            "line_end": 31,
            "display": "replit.md:21\u201331",
            "snippet_hash": "781499375745",
            "snippet_hash_verified": true
          },
          {
            "path": "client/requirements.md",
            "line_start": 2,
            "line_end": 4,
            "display": "client/requirements.md:2\u20134",
            "snippet_hash": "d45be2f83b30",
            "snippet_hash_verified": true
          },
          {
            "path": "package.json",
            "line_start": 65,
            "line_end": 73,
            "display": "package.json:65,70,73",
            "snippet_hash": "bd12df8fa4a7",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_002",
        "statement": "The backend is a Node.js 20+ application using Express 5, exposing a REST API at /api/, written in TypeScript and bundled for production with esbuild, using Drizzle ORM for database access.",
        "section": "Architecture Snapshot",
        "evidence": [
          {
            "path": "replit.md",
            "line_start": 41,
            "line_end": 46,
            "display": "replit.md:41\u201346",
            "snippet_hash": "500e08fb1b8f",
            "snippet_hash_verified": true
          },
          {
            "path": "package.json",
            "line_start": 49,
            "line_end": 52,
            "display": "package.json:49,52",
            "snippet_hash": "c65672bd1705",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_003",
        "statement": "Schema/type definitions are separated into a shared layer using Zod to prevent contract drift between components.",
        "section": "Architecture Snapshot",
        "evidence": [
          {
            "path": "replit.md",
            "line_start": 17,
            "line_end": 17,
            "display": "replit.md:17",
            "snippet_hash": "6ff71f3c7f43",
            "snippet_hash_verified": true
          },
          {
            "path": "replit.md",
            "line_start": 94,
            "line_end": 95,
            "display": "replit.md:94\u201395",
            "snippet_hash": "27e8f8ec309e",
            "snippet_hash_verified": true
          },
          {
            "path": "replit.md",
            "line_start": 50,
            "line_end": 50,
            "display": "replit.md:50",
            "snippet_hash": "361176aeb2f1",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_004",
        "statement": "The analyzer is a Python 3.11+ CLI built with Typer, orchestrating deterministic and LLM analysis modes and emitting all dossiers.",
        "section": "Architecture Snapshot",
        "evidence": [
          {
            "path": "replit.md",
            "line_start": 54,
            "line_end": 61,
            "display": "replit.md:54\u201361",
            "snippet_hash": "ffe1d23f37ee",
            "snippet_hash_verified": true
          },
          {
            "path": "pyproject.toml",
            "line_start": 2,
            "line_end": 12,
            "display": "pyproject.toml:2,12",
            "snippet_hash": "f0d4a96fe7d6",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_005",
        "statement": "The system relies on an external PostgreSQL 14+ instance for persistent data storage, with schema and migrations managed by Drizzle Kit and configured via the environment variable DATABASE_URL.",
        "section": "Architecture Snapshot",
        "evidence": [
          {
            "path": "drizzle.config.ts",
            "line_start": 3,
            "line_end": 12,
            "display": "drizzle.config.ts:3,10\u201312",
            "snippet_hash": "a19790628fbe",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_006",
        "statement": "Frontend assets are built using Vite and the server uses esbuild, with output in dist/public and dist/index.cjs, respectively.",
        "section": "Architecture Snapshot",
        "evidence": [
          {
            "path": "vite.config.ts",
            "line_start": 29,
            "line_end": 31,
            "display": "vite.config.ts:29\u201331",
            "snippet_hash": "44adb1751881",
            "snippet_hash_verified": true
          },
          {
            "path": "package.json",
            "line_start": 8,
            "line_end": 8,
            "display": "package.json:8",
            "snippet_hash": "79d8bdf275d6",
            "snippet_hash_verified": true
          },
          {
            "path": "Dockerfile",
            "line_start": 11,
            "line_end": 15,
            "display": "Dockerfile:11,15",
            "snippet_hash": "9729b411621b",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      }
    ],
    "Identity of Target System": [
      {
        "id": "claim_007",
        "statement": "Program Totality Analyzer (PTA) does not perform any dynamic or interactive runtime analysis, such as program tracing or eBPF instrumentation.",
        "section": "Identity of Target System",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 5,
            "line_end": 5,
            "display": "README.md:5",
            "snippet_hash": "ece9dc51808b",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_008",
        "statement": "PTA is not a security proof, correctness checker, or compliance attestor.",
        "section": "Identity of Target System",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 5,
            "line_end": 5,
            "display": "README.md:5",
            "snippet_hash": "ece9dc51808b",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_009",
        "statement": "PTA is not a database product and requires an external PostgreSQL instance.",
        "section": "Identity of Target System",
        "evidence": [
          {
            "path": "drizzle.config.ts",
            "line_start": 10,
            "line_end": 12,
            "display": "drizzle.config.ts:10\u201312",
            "snippet_hash": "d3b6ea7904ab",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_010",
        "statement": "PTA is not a deployment or containerization platform and is intended to be deployed behind a reverse proxy or inside a PaaS or host environment.",
        "section": "Identity of Target System",
        "evidence": [
          {
            "path": ".replit",
            "line_start": 16,
            "line_end": 18,
            "display": ".replit:16\u201318",
            "snippet_hash": "a969737d1389",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      }
    ],
    "Capability Map": [
      {
        "id": "claim_011",
        "statement": "All operator output and how-to steps are evidence-cited, with every step, port, config, and command mapped to its source via file:line:hash.",
        "section": "Capability Map",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 13,
            "line_end": 19,
            "display": "README.md:13\u201319",
            "snippet_hash": "70d33f05b06a",
            "snippet_hash_verified": true
          },
          {
            "path": "README.md",
            "line_start": 164,
            "line_end": 173,
            "display": "README.md:164\u2013173",
            "snippet_hash": "b7edf9475933",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_012",
        "statement": "The analyzer supports both structural deterministic mode (without LLM) and semantic LLM-augmented extraction, toggleable via a --no-llm flag.",
        "section": "Capability Map",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 59,
            "line_end": 67,
            "display": "README.md:59\u201367",
            "snippet_hash": "3e70dec9b544",
            "snippet_hash_verified": true
          },
          {
            "path": "README.md",
            "line_start": 216,
            "line_end": 221,
            "display": "README.md:216\u2013221",
            "snippet_hash": "e3b0c44298fc",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_013",
        "statement": "PTA can analyze GitHub URLs, local folders, or the current Replit workspace for artifacts.",
        "section": "Capability Map",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 42,
            "line_end": 57,
            "display": "README.md:42\u201357",
            "snippet_hash": "b41698313679",
            "snippet_hash_verified": true
          },
          {
            "path": "replit.md",
            "line_start": 56,
            "line_end": 59,
            "display": "replit.md:56\u201359",
            "snippet_hash": "22085c032d95",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_014",
        "statement": "PTA extracts referenced environment variables, API keys, and network ports used by the application.",
        "section": "Capability Map",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 70,
            "line_end": 71,
            "display": "README.md:70\u201371",
            "snippet_hash": "55f9671fedce",
            "snippet_hash_verified": true
          },
          {
            "path": "drizzle.config.ts",
            "line_start": 3,
            "line_end": 3,
            "display": "drizzle.config.ts:3",
            "snippet_hash": "a19790628fbe",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_015",
        "statement": "PTA detects public and private API endpoints, operational gaps, missing evidence, and unknowns in the analysis.",
        "section": "Capability Map",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 156,
            "line_end": 162,
            "display": "README.md:156\u2013162",
            "snippet_hash": "a982bf03455e",
            "snippet_hash_verified": true
          },
          {
            "path": "README.md",
            "line_start": 173,
            "line_end": 174,
            "display": "README.md:173\u2013174",
            "snippet_hash": "b29c58db2d6a",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      }
    ],
    "Integration Surface": [
      {
        "id": "claim_016",
        "statement": "All operations are exposed via well-documented REST API endpoints under the /api/ path, including /api/health, /api/ready, /api/audit/verify, and /api/receipts/:id/lock.",
        "section": "Integration Surface",
        "evidence": [
          {
            "path": "docs/dossiers/lantern_program_totality_dossier.md",
            "line_start": 160,
            "line_end": 160,
            "display": "docs/dossiers/lantern_program_totality_dossier.md:160",
            "snippet_hash": "ff679a4bae68",
            "snippet_hash_verified": true
          },
          {
            "path": "replit.md",
            "line_start": 43,
            "line_end": 52,
            "display": "replit.md:43\u201352",
            "snippet_hash": "b5225b713362",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_017",
        "statement": "Private API endpoints require an API key to be sent in the x-api-key HTTP header for authentication.",
        "section": "Integration Surface",
        "evidence": [
          {
            "path": "docs/dossiers/lantern_program_totality_dossier.md",
            "line_start": 151,
            "line_end": 151,
            "display": "docs/dossiers/lantern_program_totality_dossier.md:151",
            "snippet_hash": "ab249b766ec2",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_018",
        "statement": "All API payloads use JSON format and are validated using Zod schemas.",
        "section": "Integration Surface",
        "evidence": [
          {
            "path": "replit.md",
            "line_start": 42,
            "line_end": 43,
            "display": "replit.md:42\u201343",
            "snippet_hash": "db5d6b0bd030",
            "snippet_hash_verified": true
          },
          {
            "path": "package.json",
            "line_start": 79,
            "line_end": 79,
            "display": "package.json:79",
            "snippet_hash": "99a7ac896517",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      }
    ],
    "Data & Security Posture": [
      {
        "id": "claim_021",
        "statement": "All data persists in an external PostgreSQL database, connection configured by the DATABASE_URL environment variable.",
        "section": "Data & Security Posture",
        "evidence": [
          {
            "path": "drizzle.config.ts",
            "line_start": 3,
            "line_end": 3,
            "display": "drizzle.config.ts:3",
            "snippet_hash": "a19790628fbe",
            "snippet_hash_verified": true
          },
          {
            "path": "drizzle.config.ts",
            "line_start": 10,
            "line_end": 12,
            "display": "drizzle.config.ts:10\u201312",
            "snippet_hash": "d3b6ea7904ab",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_023",
        "statement": "Secrets and sensitive runtime configuration are handled via environment variables; only their names are ever surfaced in analysis output, not values.",
        "section": "Data & Security Posture",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 146,
            "line_end": 146,
            "display": "README.md:146",
            "snippet_hash": "68ac2dc8bd72",
            "snippet_hash_verified": true
          },
          {
            "path": "drizzle.config.ts",
            "line_start": 3,
            "line_end": 3,
            "display": "drizzle.config.ts:3",
            "snippet_hash": "a19790628fbe",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_024",
        "statement": "Session authentication uses express-session with SESSION_SECRET and API access is guarded by API_KEY.",
        "section": "Data & Security Posture",
        "evidence": [
          {
            "path": "package.json",
            "line_start": 53,
            "line_end": 53,
            "display": "package.json:53",
            "snippet_hash": "abb52cbb888c",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_025",
        "statement": "OpenAI LLM integrations require AI_INTEGRATIONS_OPENAI_API_KEY and AI_INTEGRATIONS_OPENAI_BASE_URL in the environment; these are not required for deterministic mode.",
        "section": "Data & Security Posture",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 85,
            "line_end": 86,
            "display": "README.md:85\u201386",
            "snippet_hash": "7fb69856946c",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_026",
        "statement": "Network port 5000 is the HTTP server default (settable by env), mapped externally to 80 by Replit and Docker.",
        "section": "Data & Security Posture",
        "evidence": [
          {
            "path": ".replit",
            "line_start": 10,
            "line_end": 11,
            "display": ".replit:10\u201311",
            "snippet_hash": "47abfb4488e8",
            "snippet_hash_verified": true
          },
          {
            "path": "Dockerfile",
            "line_start": 18,
            "line_end": 18,
            "display": "Dockerfile:18",
            "snippet_hash": "2ab60fd4a4e2",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      },
      {
        "id": "claim_027",
        "statement": "The only configured external service contact is to OpenAI for optional LLM mode; no other external connections are evidenced.",
        "section": "Data & Security Posture",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 85,
            "line_end": 86,
            "display": "README.md:85\u201386",
            "snippet_hash": "7fb69856946c",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      }
    ],
    "Operational Reality": [
      {
        "id": "claim_028",
        "statement": "System operation requires Node.js 20+ and Python 3.11+, with PostgreSQL online and reachable, and secrets properly configured in .env.",
        "section": "Operational Reality",
        "evidence": [
          {
            "path": "README.md",
            "line_start": 39,
            "line_end": 39,
            "display": "README.md:39",
            "snippet_hash": "e3b0c44298fc",
            "snippet_hash_verified": true
          },
          {
            "path": "README.md",
            "line_start": 47,
            "line_end": 47,
            "display": "README.md:47",
            "snippet_hash": "f1b901847390",
            "snippet_hash_verified": true
          },
          {
            "path": "replit.md",
            "line_start": 71,
            "line_end": 73,
            "display": "replit.md:71\u201373",
            "snippet_hash": "a01caa356215",
            "snippet_hash_verified": true
          },
          {
            "path": "Dockerfile",
            "line_start": 18,
            "line_end": 18,
            "display": "Dockerfile:18",
            "snippet_hash": "2ab60fd4a4e2",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      }
    ],
    "Maintainability & Change Risk": [
      {
        "id": "claim_029",
        "statement": "Shared schemas/types and deterministic extractors guard against contract drift and reduce the need for LLM involvement in most operator steps.",
        "section": "Maintainability & Change Risk",
        "evidence": [
          {
            "path": "replit.md",
            "line_start": 17,
            "line_end": 17,
            "display": "replit.md:17",
            "snippet_hash": "6ff71f3c7f43",
            "snippet_hash_verified": true
          },
          {
            "path": "README.md",
            "line_start": 59,
            "line_end": 63,
            "display": "README.md:59\u201363",
            "snippet_hash": "3e70dec9b544",
            "snippet_hash_verified": true
          }
        ],
        "confidence": 1.0
      }
    ]
  },
  "verified_structural": {
    "routes": [],
    "dependencies": [],
    "schemas": [],
    "enforcement": [],
    "_notes": {
      "routes": "not_implemented: requires AST/regex route extractor over source files",
      "dependencies": "not_implemented: requires lockfile parser (package-lock.json, requirements.txt, etc.)",
      "schemas": "not_implemented: requires migration/model file parser",
      "enforcement": "not_implemented: requires auth/middleware pattern detector over source files"
    }
  },
  "unknowns": [
    {
      "category": "tls_termination",
      "description": "Whether TLS/SSL is terminated and how (reverse proxy, load balancer, application-level)",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "No matching infrastructure/config artifacts found in file index",
      "resolve_with": "Add TLS config: k8s Ingress with tls section, nginx.conf with ssl_certificate, Caddyfile with tls directive, or Terraform aws_acm_certificate resource"
    },
    {
      "category": "encryption_at_rest",
      "description": "Whether data at rest is encrypted (database, file storage, backups)",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "No matching infrastructure/config artifacts found in file index",
      "resolve_with": "Add encryption config: Terraform aws_db_instance with storage_encrypted=true, k8s StorageClass with encrypted parameters, or pgcrypto extension usage"
    },
    {
      "category": "secret_management",
      "description": "How secrets/credentials are stored, rotated, and accessed at runtime",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "No matching infrastructure/config artifacts found in file index",
      "resolve_with": "Add secret management: k8s ExternalSecret/SealedSecret manifests, Vault agent config, or Terraform vault_generic_secret resources"
    },
    {
      "category": "deployment_topology",
      "description": "Production deployment architecture (containers, VMs, serverless, regions)",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "Candidate artifact files found (Dockerfile) but artifact detector not yet implemented \u2014 cannot read/hash/verify file content",
      "resolve_with": "Add deployment artifacts: Dockerfile, docker-compose.yml, k8s Deployment manifests, Terraform main.tf, Helm Chart.yaml, or fly.toml"
    },
    {
      "category": "runtime_iam",
      "description": "Identity and access management at runtime (service accounts, role-based access)",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "No matching infrastructure/config artifacts found in file index",
      "resolve_with": "Add IAM config: k8s ServiceAccount/RBAC manifests, Terraform aws_iam_role resources, or OPA policy files"
    },
    {
      "category": "logging_sink",
      "description": "Where application and infrastructure logs are collected and retained",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "No matching infrastructure/config artifacts found in file index",
      "resolve_with": "Add logging config: Fluentd/Logstash config files, k8s logging sidecar manifests, or Terraform CloudWatch log group resources"
    },
    {
      "category": "monitoring_alerting",
      "description": "Whether monitoring/alerting is configured (health checks, uptime, error rates)",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "No matching infrastructure/config artifacts found in file index",
      "resolve_with": "Add monitoring config: Prometheus rules YAML, Grafana dashboard JSON, k8s ServiceMonitor manifests, Terraform CloudWatch alarm resources, or Sentry config"
    },
    {
      "category": "backup_retention",
      "description": "Backup strategy, frequency, and retention policy for data stores",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "No matching infrastructure/config artifacts found in file index",
      "resolve_with": "Add backup config: Terraform aws_backup_plan resources, k8s CronJob backup manifests, or pg_dump/mongodump cron scripts with retention"
    },
    {
      "category": "data_residency",
      "description": "Where data is physically stored and whether data residency requirements are met",
      "status": "UNKNOWN",
      "evidence": [],
      "notes": "No matching infrastructure/config artifacts found in file index",
      "resolve_with": "Add residency config: Terraform provider region constraints, k8s node affinity with topology labels, or documented data residency policy"
    }
  ],
  "metrics": {
    "rci_reporting_completeness": {
      "score": 0.5222,
      "label": "RCI \u2014 Reporting Completeness",
      "formula": "average(claims_coverage, unknowns_coverage, howto_completeness)",
      "components": {
        "claims_coverage": 0.8667,
        "unknowns_coverage": 0.0,
        "howto_completeness": 0.7
      },
      "interpretation": "Composite completeness of PTA reporting. NOT a security or structural visibility score."
    },
    "dci_v1_claim_visibility": {
      "score": 0.8667,
      "label": "DCI_v1_claim_visibility",
      "formula": "verified_claims / total_claims",
      "interpretation": "Percent of claims with deterministic hash-verified evidence. This is claim-evidence visibility, NOT system surface visibility."
    },
    "dci_v2_structural_visibility": {
      "score": null,
      "label": "DCI_v2_structural_visibility (not implemented)",
      "formula": "verified_structural_items / total_structural_surface",
      "interpretation": "Structural surface visibility (routes/deps/schemas/enforcement). Not yet implemented \u2014 requires dedicated structural extractors.",
      "status": "not_implemented"
    }
  },
  "hashes": {
    "snippets": [
      "020435ddf436",
      "03b0895d239a",
      "22085c032d95",
      "232f2a0c483a",
      "27e8f8ec309e",
      "2ab60fd4a4e2",
      "361176aeb2f1",
      "3e70dec9b544",
      "44adb1751881",
      "4530c109285c",
      "46effdb3adbb",
      "47abfb4488e8",
      "500e08fb1b8f",
      "55f9671fedce",
      "68ac2dc8bd72",
      "6bfea429a287",
      "6ff71f3c7f43",
      "70d33f05b06a",
      "781499375745",
      "79d8bdf275d6",
      "7fb69856946c",
      "887abc9f5ccb",
      "92755120ac2c",
      "9729b411621b",
      "99a7ac896517",
      "a01caa356215",
      "a19790628fbe",
      "a969737d1389",
      "a982bf03455e",
      "ab249b766ec2",
      "abb52cbb888c",
      "af4db2203afc",
      "b29c58db2d6a",
      "b41698313679",
      "b5225b713362",
      "b7edf9475933",
      "bce1008b2a9d",
      "bd12df8fa4a7",
      "c65672bd1705",
      "d3b6ea7904ab",
      "d45be2f83b30",
      "db5d6b0bd030",
      "e3b0c44298fc",
      "ecd94c8e718d",
      "ece9dc51808b",
      "f0d4a96fe7d6",
      "f1b901847390",
      "fd240a9dc053",
      "ff679a4bae68",
      "ffe1d23f37ee"
    ]
  },
  "summary": {
    "total_files": 191,
    "total_claims": 30,
    "verified_claims": 26,
    "unknown_categories": 9,
    "verified_categories": 0
  },
  "coverage": {
    "analyzed_files": 191,
    "total_files_seen": 191,
    "skipped_files": 0,
    "skipped_types": [],
    "timeouts": [],
    "partial": false
  }
}