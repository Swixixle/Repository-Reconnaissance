{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ClaimsOutput",
  "description": "Structured claims extracted from dossier, each with verifiable evidence objects",
  "type": "object",
  "required": ["claims", "mode", "run_id", "is_replit"],
  "properties": {
    "mode": {
      "type": "string",
      "enum": ["github", "local", "replit"],
      "description": "Acquisition mode used"
    },
    "run_id": {
      "type": ["string", "null"],
      "description": "Unique run identifier (12-char hex)"
    },
    "is_replit": {
      "type": "boolean",
      "description": "Whether target is a Replit workspace"
    },
    "claims": {
      "type": "array",
      "maxItems": 30,
      "items": {
        "type": "object",
        "required": ["id", "section", "statement", "confidence", "evidence", "status"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^claim_\\d{3}$",
            "description": "Unique claim ID, e.g. claim_001"
          },
          "section": {
            "type": "string",
            "description": "Dossier section this claim belongs to"
          },
          "statement": {
            "type": "string",
            "description": "The exact factual claim"
          },
          "confidence": {
            "type": "number",
            "minimum": 0.0,
            "maximum": 1.0,
            "description": "Confidence score. Capped at 0.20 if no verified evidence."
          },
          "evidence": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/evidence_object"
            },
            "description": "Array of structured evidence citations"
          },
          "status": {
            "type": "string",
            "enum": ["evidenced", "inferred", "unknown", "unverified"],
            "description": "evidenced=file:line proof, inferred=indirect, unknown=none, unverified=hash failed"
          }
        }
      }
    }
  },
  "definitions": {
    "evidence_object": {
      "type": "object",
      "required": ["path", "line_start", "line_end", "snippet_hash", "display"],
      "properties": {
        "path": {
          "type": "string",
          "description": "Relative file path from repo root"
        },
        "line_start": {
          "type": "integer",
          "minimum": 0,
          "description": "Start line number (1-based, 0 = file-level)"
        },
        "line_end": {
          "type": "integer",
          "minimum": 0,
          "description": "End line number (1-based)"
        },
        "snippet_hash": {
          "type": "string",
          "pattern": "^[a-f0-9]{12}$",
          "description": "First 12 chars of SHA-256 of the snippet text, computed server-side"
        },
        "display": {
          "type": "string",
          "description": "Human-readable citation, e.g. 'server/index.ts:92'"
        },
        "snippet_hash_verified": {
          "type": "boolean",
          "description": "True if server re-read the file and confirmed the hash matches"
        }
      }
    }
  }
}
